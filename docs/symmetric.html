<html><head><title>TSec: Symmetric Ciphers</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Jose Cardona" /><meta name="description" content="A Type-Safe General Cryptography Library on the JVM" /><meta name="og:image" content="/tsec/img/poster.png" /><meta name="og:title" content="TSec: Symmetric Ciphers" /><meta name="og:site_name" content="TSec" /><meta name="og:url" content="https://jmcardon.github.io/tsec/" /><meta name="og:type" content="website" /><meta name="og:description" content="A Type-Safe General Cryptography Library on the JVM" /><link rel="icon" type="image/png" href="/tsec/img/favicon.png" /><meta name="twitter:title" content="TSec: Symmetric Ciphers" /><meta name="twitter:image" content="https://jmcardon.github.io/tsec/img/poster.png" /><meta name="twitter:description" content="A Type-Safe General Cryptography Library on the JVM" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/tsec/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/tsec/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/tsec/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/tsec/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/tsec/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/tsec/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/tsec/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/tsec/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/tsec/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/tsec/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/tsec/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/tsec/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/tsec/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/tsec/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/tsec/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/tsec/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/tsec/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/tsec/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/tsec/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/tsec/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/tsec/highlight/styles/default.css" /><link rel="stylesheet" href="/tsec/css/style.css" /><link rel="stylesheet" href="/tsec/css/palette.css" /><link rel="stylesheet" href="/tsec/css/codemirror.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/tsec/" class="brand"><div class="brand-wrapper"><span>TSec</span></div></a></li> <li><a href="/tsec/docs/symmetric.html" class=" active ">Symmetric Ciphers</a></li> <li><a href="/tsec/docs/messagedigests.html" class="">Message Digests</a></li> <li><a href="/tsec/docs/passwordhashers.html" class="">Password Hashers</a></li> <li><a href="/tsec/docs/mac.html" class="">Message Authentication</a></li> <li><a href="/tsec/docs/signatures.html" class="">Digital Signatures</a></li> <li><a href="/tsec/docs/jwt-mac.html" class="">JWT</a></li> <li><a href="/tsec/docs/http4s-auth.html" class="">Http4s-Auth</a> <ul class="sub_section"> <li><a href="/tsec/docs/http4s-auth.html" class="">Overview</a></li> <li><a href="/tsec/docs/http4s/auth-scookie.html" class="">Signed Cookies</a></li> <li><a href="/tsec/docs/http4s/auth-ecookie.html" class="">Encrypted Cookies</a></li> <li><a href="/tsec/docs/http4s/auth-jwt.html" class="">JWT</a></li> <li><a href="/tsec/docs/http4s/auth-bearer.html" class="">Bearer Token</a></li> <li><a href="/tsec/docs/http4s/authorization.html" class="">Authorization</a></li> <li><a href="/tsec/docs/http4s/csrf.html" class="">CSRF</a></li></ul></li> <li><a href="/tsec/docs/common.html" class="">Common Utils</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/jmcardon/tsec"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/jmcardon/tsec"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('TSec A Type-Safe General Cryptography Library on the JVM');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('TSec A Type-Safe General Cryptography Library on the JVM');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="jmcardon" data-github-repo="tsec"><div class="content-wrapper"><section><h1 id="symmetric-ciphers">Symmetric Ciphers</h1>

<h3 id="important-note">Important note:</h3>
<p>For 256-bit key sizes, you will have to install the
Java Cryptography Extension (JCE) Unlimited Strength Jurisdiction Policy</p>

<p>You can get it <a href="http://www.oracle.com/technetwork/java/javase/downloads/jce8-download-2133166.html">here</a></p>

<p>You can refer to <a href="https://stackoverflow.com/questions/41580489/how-to-install-unlimited-strength-jurisdiction-policy-files">this</a> for installation help</p>

<p>Alternatively, if you are using a package manager like aptitude and have the java8 repositories on your machine,
you can install oracle-java8-unlimited-jce-policy</p>

<p>For debian-like distros:
Follow the instructions <a href="http://tipsonubuntu.com/2016/07/31/install-oracle-java-8-9-ubuntu-16-04-linux-mint-18">here</a>
then use: <code class="highlighter-rouge">sudo apt-get install oracle-java8-unlimited-jce-policy</code></p>

<h2 id="introduction">Introduction</h2>

<p>For symmetric ciphers, we provide a low level as well as a high-level api construction.</p>

<p>Symmetric ciphers, as an introduction, have the following basic properties, for all non-empty m (as,  if a message is
empty, youâ€™re not encrypting anything and c = m):</p>
<div class="highlighter-rouge"><pre class="highlight"><code> E(K, m) = c
 D(K, c) = m
 D(K, E(K, m)) = m
 
 Where:
    E: Encryption function
    D: Decryption function
    K: Some symmetric key
    m: Some message, or plainText
    c: Some ciphertext
</code></pre>
</div>

<p>However, in practice, block ciphers (and most secure stream ciphers like Salsa20) require a nonce as well
(called an initialization vector for block ciphers). As such, we need to either provide it explicitly, or
implicitly in our cipher construction. TSec provides such an implicit construction using <code class="highlighter-rouge">IvStrategy</code>.</p>

<h2 id="usage">Usage</h2>

<p>These are the imports you will need for basic usage:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code>  <span class="k">import</span> <span class="nn">tsec.common._</span>
  <span class="k">import</span> <span class="nn">tsec.cipher.symmetric._</span>
  <span class="k">import</span> <span class="nn">tsec.cipher.symmetric.jca._</span>
  <span class="k">import</span> <span class="nn">cats.effect.IO</span>
</code></pre>
</div>

<p>In tsec, we provide a few default constructions for simple AES encryption:
<code class="highlighter-rouge">AES/CTR</code> and <code class="highlighter-rouge">AES/CBC</code>. For Authenticated encryption, 
we provide an <code class="highlighter-rouge">AES/GCM</code> construction.</p>

<p>To be able to generate initialization vectors for a particular cipher, you must either
have an implicit <code class="highlighter-rouge">IvStrategy[A]</code>(where A is the algorithm type, i.e <code class="highlighter-rouge">AES128GCM</code>) in scope, or pass it explicitly,
or use it to generate a nonce of the right size:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span>   <span class="k">val</span> <span class="n">toEncrypt</span> <span class="k">=</span> <span class="s">"hi hello welcome to tsec"</span><span class="o">.</span><span class="n">utf8Bytes</span>
<span class="n">toEncrypt</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">Byte</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">104</span><span class="o">,</span> <span class="mi">105</span><span class="o">,</span> <span class="mi">32</span><span class="o">,</span> <span class="mi">104</span><span class="o">,</span> <span class="mi">101</span><span class="o">,</span> <span class="mi">108</span><span class="o">,</span> <span class="mi">108</span><span class="o">,</span> <span class="mi">111</span><span class="o">,</span> <span class="mi">32</span><span class="o">,</span> <span class="mi">119</span><span class="o">,</span> <span class="mi">101</span><span class="o">,</span> <span class="mi">108</span><span class="o">,</span> <span class="mi">99</span><span class="o">,</span> <span class="mi">111</span><span class="o">,</span> <span class="mi">109</span><span class="o">,</span> <span class="mi">101</span><span class="o">,</span> <span class="mi">32</span><span class="o">,</span> <span class="mi">116</span><span class="o">,</span> <span class="mi">111</span><span class="o">,</span> <span class="mi">32</span><span class="o">,</span> <span class="mi">116</span><span class="o">,</span> <span class="mi">115</span><span class="o">,</span> <span class="mi">101</span><span class="o">,</span> <span class="mi">99</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span>   <span class="k">implicit</span> <span class="k">val</span> <span class="n">ctrStrategy</span><span class="k">:</span> <span class="kt">IvGen</span><span class="o">[</span><span class="kt">IO</span>, <span class="kt">AES128CTR</span><span class="o">]</span> <span class="k">=</span> <span class="nc">AES128CTR</span><span class="o">.</span><span class="n">defaultIvStrategy</span><span class="o">[</span><span class="kt">IO</span><span class="o">]</span>
<span class="n">ctrStrategy</span><span class="k">:</span> <span class="kt">tsec.cipher.symmetric.IvGen</span><span class="o">[</span><span class="kt">cats.effect.IO</span>,<span class="kt">tsec.cipher.symmetric.jca.AES128CTR</span><span class="o">]</span> <span class="k">=</span> <span class="n">tsec</span><span class="o">.</span><span class="n">cipher</span><span class="o">.</span><span class="n">symmetric</span><span class="o">.</span><span class="n">jca</span><span class="o">.</span><span class="nc">JCAIvGen$$anon$1</span><span class="k">@</span><span class="mi">4</span><span class="n">c762584</span>

<span class="n">scala</span><span class="o">&gt;</span>   <span class="k">val</span> <span class="n">onlyEncrypt</span><span class="k">:</span> <span class="kt">IO</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">AES128CTR</span><span class="o">.</span><span class="n">genEncryptor</span><span class="o">[</span><span class="kt">IO</span><span class="o">].</span><span class="n">flatMap</span><span class="o">(</span>
     <span class="o">|</span>       <span class="k">implicit</span> <span class="n">instance</span> <span class="k">=&gt;</span>
     <span class="o">|</span>         <span class="k">for</span> <span class="o">{</span>
     <span class="o">|</span>           <span class="n">key</span>       <span class="k">&lt;-</span> <span class="nc">AES128CTR</span><span class="o">.</span><span class="n">generateKey</span><span class="o">[</span><span class="kt">IO</span><span class="o">]</span> <span class="c1">//Generate our key
</span>     <span class="o">|</span>           <span class="n">encrypted</span> <span class="k">&lt;-</span> <span class="nc">AES128CTR</span><span class="o">.</span><span class="n">encrypt</span><span class="o">[</span><span class="kt">IO</span><span class="o">](</span><span class="nc">PlainText</span><span class="o">(</span><span class="n">toEncrypt</span><span class="o">),</span> <span class="n">key</span><span class="o">)</span> <span class="c1">//Encrypt our message
</span>     <span class="o">|</span>           <span class="n">decrypted</span> <span class="k">&lt;-</span> <span class="nc">AES128CTR</span><span class="o">.</span><span class="n">decrypt</span><span class="o">[</span><span class="kt">IO</span><span class="o">](</span><span class="n">encrypted</span><span class="o">,</span> <span class="n">key</span><span class="o">)</span>
     <span class="o">|</span>         <span class="o">}</span> <span class="k">yield</span> <span class="n">decrypted</span><span class="o">.</span><span class="n">toUtf8String</span>
     <span class="o">|</span>     <span class="o">)</span> <span class="c1">// "hi hello welcome to tsec!"
</span><span class="n">onlyEncrypt</span><span class="k">:</span> <span class="kt">cats.effect.IO</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">IO$1484145226</span>

<span class="n">scala</span><span class="o">&gt;</span>   <span class="cm">/** You can also turn it into a singular array with the IV concatenated at the end */</span>
     <span class="o">|</span>   <span class="k">val</span> <span class="n">onlyEncrypt2</span><span class="k">:</span> <span class="kt">IO</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">AES128CTR</span><span class="o">.</span><span class="n">genEncryptor</span><span class="o">[</span><span class="kt">IO</span><span class="o">].</span><span class="n">flatMap</span><span class="o">(</span>
     <span class="o">|</span>       <span class="k">implicit</span> <span class="n">instance</span> <span class="k">=&gt;</span>
     <span class="o">|</span>         <span class="k">for</span> <span class="o">{</span>
     <span class="o">|</span>           <span class="n">key</span>       <span class="k">&lt;-</span> <span class="nc">AES128CTR</span><span class="o">.</span><span class="n">generateKey</span><span class="o">[</span><span class="kt">IO</span><span class="o">]</span>                        <span class="c1">//Generate our key
</span>     <span class="o">|</span>           <span class="n">encrypted</span> <span class="k">&lt;-</span> <span class="nc">AES128CTR</span><span class="o">.</span><span class="n">encrypt</span><span class="o">[</span><span class="kt">IO</span><span class="o">](</span><span class="nc">PlainText</span><span class="o">(</span><span class="n">toEncrypt</span><span class="o">),</span> <span class="n">key</span><span class="o">)</span> <span class="c1">//Encrypt our message
</span>     <span class="o">|</span>           <span class="n">array</span> <span class="k">=</span> <span class="n">encrypted</span><span class="o">.</span><span class="n">toConcatenated</span>
     <span class="o">|</span>           <span class="n">from</span>      <span class="k">&lt;-</span> <span class="nc">IO</span><span class="o">.</span><span class="n">fromEither</span><span class="o">(</span><span class="nc">AES128CTR</span><span class="o">.</span><span class="n">ciphertextFromConcat</span><span class="o">(</span><span class="n">array</span><span class="o">))</span>
     <span class="o">|</span>           <span class="n">decrypted</span> <span class="k">&lt;-</span> <span class="nc">AES128CTR</span><span class="o">.</span><span class="n">decrypt</span><span class="o">[</span><span class="kt">IO</span><span class="o">](</span><span class="n">from</span><span class="o">,</span> <span class="n">key</span><span class="o">)</span>
     <span class="o">|</span>         <span class="o">}</span> <span class="k">yield</span> <span class="n">decrypted</span><span class="o">.</span><span class="n">toUtf8String</span>
     <span class="o">|</span>     <span class="o">)</span> <span class="c1">// "hi hello welcome to tsec!"
</span><span class="n">onlyEncrypt2</span><span class="k">:</span> <span class="kt">cats.effect.IO</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">IO$1824458388</span>
</code></pre>
</div>

<p>For authenticated encryption and decryption</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span>   <span class="k">implicit</span> <span class="k">val</span> <span class="n">gcmstrategy</span> <span class="k">=</span> <span class="nc">AES128GCM</span><span class="o">.</span><span class="n">defaultIvStrategy</span><span class="o">[</span><span class="kt">IO</span><span class="o">]</span>
<span class="n">gcmstrategy</span><span class="k">:</span> <span class="kt">tsec.cipher.symmetric.IvGen</span><span class="o">[</span><span class="kt">cats.effect.IO</span>,<span class="kt">tsec.cipher.symmetric.jca.AES128GCM</span><span class="o">]</span> <span class="k">=</span> <span class="n">tsec</span><span class="o">.</span><span class="n">cipher</span><span class="o">.</span><span class="n">symmetric</span><span class="o">.</span><span class="n">jca</span><span class="o">.</span><span class="n">package$GCM$$anon$1</span><span class="k">@</span><span class="mf">46048d</span><span class="mi">72</span>

<span class="n">scala</span><span class="o">&gt;</span>   <span class="k">val</span> <span class="n">aad</span> <span class="k">=</span> <span class="nc">AAD</span><span class="o">(</span><span class="s">"myAdditionalAuthenticationData"</span><span class="o">.</span><span class="n">utf8Bytes</span><span class="o">)</span>
<span class="n">aad</span><span class="k">:</span> <span class="kt">tsec.cipher.symmetric.AAD.Type</span> <span class="o">=</span> <span class="nc">Array</span><span class="o">(</span><span class="mi">109</span><span class="o">,</span> <span class="mi">121</span><span class="o">,</span> <span class="mi">65</span><span class="o">,</span> <span class="mi">100</span><span class="o">,</span> <span class="mi">100</span><span class="o">,</span> <span class="mi">105</span><span class="o">,</span> <span class="mi">116</span><span class="o">,</span> <span class="mi">105</span><span class="o">,</span> <span class="mi">111</span><span class="o">,</span> <span class="mi">110</span><span class="o">,</span> <span class="mi">97</span><span class="o">,</span> <span class="mi">108</span><span class="o">,</span> <span class="mi">65</span><span class="o">,</span> <span class="mi">117</span><span class="o">,</span> <span class="mi">116</span><span class="o">,</span> <span class="mi">104</span><span class="o">,</span> <span class="mi">101</span><span class="o">,</span> <span class="mi">110</span><span class="o">,</span> <span class="mi">116</span><span class="o">,</span> <span class="mi">105</span><span class="o">,</span> <span class="mi">99</span><span class="o">,</span> <span class="mi">97</span><span class="o">,</span> <span class="mi">116</span><span class="o">,</span> <span class="mi">105</span><span class="o">,</span> <span class="mi">111</span><span class="o">,</span> <span class="mi">110</span><span class="o">,</span> <span class="mi">68</span><span class="o">,</span> <span class="mi">97</span><span class="o">,</span> <span class="mi">116</span><span class="o">,</span> <span class="mi">97</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span>   <span class="k">val</span> <span class="n">encryptAAD</span><span class="k">:</span> <span class="kt">IO</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">AES128GCM</span><span class="o">.</span><span class="n">genEncryptor</span><span class="o">[</span><span class="kt">IO</span><span class="o">].</span><span class="n">flatMap</span><span class="o">(</span>
     <span class="o">|</span>       <span class="k">implicit</span> <span class="n">instance</span> <span class="k">=&gt;</span>
     <span class="o">|</span>         <span class="k">for</span> <span class="o">{</span>
     <span class="o">|</span>           <span class="n">key</span>       <span class="k">&lt;-</span> <span class="nc">AES128GCM</span><span class="o">.</span><span class="n">generateKey</span><span class="o">[</span><span class="kt">IO</span><span class="o">]</span>                                    <span class="c1">//Generate our key
</span>     <span class="o">|</span>           <span class="n">encrypted</span> <span class="k">&lt;-</span> <span class="nc">AES128GCM</span><span class="o">.</span><span class="n">encryptWithAAD</span><span class="o">[</span><span class="kt">IO</span><span class="o">](</span><span class="nc">PlainText</span><span class="o">(</span><span class="n">toEncrypt</span><span class="o">),</span> <span class="n">key</span><span class="o">,</span> <span class="n">aad</span><span class="o">)</span> <span class="c1">//Encrypt
</span>     <span class="o">|</span>           <span class="n">decrypted</span> <span class="k">&lt;-</span> <span class="nc">AES128GCM</span><span class="o">.</span><span class="n">decryptWithAAD</span><span class="o">[</span><span class="kt">IO</span><span class="o">](</span><span class="n">encrypted</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span> <span class="n">aad</span><span class="o">)</span>            <span class="c1">//Decrypt
</span>     <span class="o">|</span>         <span class="o">}</span> <span class="k">yield</span> <span class="n">decrypted</span><span class="o">.</span><span class="n">toUtf8String</span>
     <span class="o">|</span>     <span class="o">)</span> <span class="c1">// "hi hello welcome to tsec!"
</span><span class="n">encryptAAD</span><span class="k">:</span> <span class="kt">cats.effect.IO</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">IO$1089935753</span>
</code></pre>
</div>

<p>Finally, For more advanced usage, i.e you know which cipher you want specifically, you must import 
both padding as well as the primitive package.</p>

<p>Note: This is not recommended. Use at your own risk.</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span>   <span class="cm">/** For more advanced usage, i.e you know which cipher you want specifically, you must import padding
     |     * as well as the low level package
     |     *
     |     * this is not recommended, but useful for.. science!
     |     *
     |     */</span>
     <span class="o">|</span>   <span class="k">import</span> <span class="nn">tsec.cipher.common.padding._</span>
<span class="k">import</span> <span class="nn">tsec.cipher.common.padding._</span>

<span class="n">scala</span><span class="o">&gt;</span>   <span class="k">import</span> <span class="nn">tsec.cipher.symmetric.jca.primitive._</span>
<span class="k">import</span> <span class="nn">tsec.cipher.symmetric.jca.primitive._</span>

<span class="n">scala</span><span class="o">&gt;</span>   <span class="k">val</span> <span class="n">desStrategy</span> <span class="k">=</span> <span class="nc">JCAIvGen</span><span class="o">.</span><span class="n">random</span><span class="o">[</span><span class="kt">IO</span>, <span class="kt">DES</span><span class="o">]</span>
<span class="n">desStrategy</span><span class="k">:</span> <span class="kt">tsec.cipher.symmetric.IvGen</span><span class="o">[</span><span class="kt">cats.effect.IO</span>,<span class="kt">tsec.cipher.symmetric.jca.DES</span><span class="o">]</span> <span class="k">=</span> <span class="n">tsec</span><span class="o">.</span><span class="n">cipher</span><span class="o">.</span><span class="n">symmetric</span><span class="o">.</span><span class="n">jca</span><span class="o">.</span><span class="nc">JCAIvGen$$anon$1</span><span class="k">@</span><span class="mi">207237</span><span class="n">c0</span>

<span class="n">scala</span><span class="o">&gt;</span>   <span class="k">val</span> <span class="n">advancedUsage</span><span class="k">:</span> <span class="kt">IO</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
     <span class="o">|</span>     <span class="n">instance</span>  <span class="k">&lt;-</span> <span class="nc">JCAPrimitiveCipher</span><span class="o">.</span><span class="n">sync</span><span class="o">[</span><span class="kt">IO</span>, <span class="kt">DES</span>, <span class="kt">CBC</span>, <span class="kt">PKCS7Padding</span><span class="o">]()</span>
     <span class="o">|</span>     <span class="n">key</span>       <span class="k">&lt;-</span> <span class="nc">DES</span><span class="o">.</span><span class="n">generateKey</span><span class="o">[</span><span class="kt">IO</span><span class="o">]</span>
     <span class="o">|</span>     <span class="n">iv</span>        <span class="k">&lt;-</span> <span class="n">desStrategy</span><span class="o">.</span><span class="n">genIv</span>
     <span class="o">|</span>     <span class="n">encrypted</span> <span class="k">&lt;-</span> <span class="n">instance</span><span class="o">.</span><span class="n">encrypt</span><span class="o">(</span><span class="nc">PlainText</span><span class="o">(</span><span class="n">toEncrypt</span><span class="o">),</span> <span class="n">key</span><span class="o">,</span> <span class="n">iv</span><span class="o">)</span> <span class="c1">//Encrypt our message, with our auth data
</span>     <span class="o">|</span>     <span class="n">decrypted</span> <span class="k">&lt;-</span> <span class="n">instance</span><span class="o">.</span><span class="n">decrypt</span><span class="o">(</span><span class="n">encrypted</span><span class="o">,</span> <span class="n">key</span><span class="o">)</span> <span class="c1">//Decrypt our message: We need to pass it the same AAD
</span>     <span class="o">|</span>   <span class="o">}</span> <span class="k">yield</span> <span class="n">decrypted</span><span class="o">.</span><span class="n">toUtf8String</span>
<span class="n">advancedUsage</span><span class="k">:</span> <span class="kt">cats.effect.IO</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">IO$72317432</span>
</code></pre>
</div>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/tsec/highlight/highlight.pack.js"></script><script>hljs.configure({
languages:['scala','java','bash']
});
hljs.initHighlighting();
             </script><script src="/tsec/js/main.js"></script></body></html>