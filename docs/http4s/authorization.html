<html><head><title>TSec</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Jose Cardona" /><meta name="description" content="A Type-Safe General Cryptography Library on the JVM" /><meta name="og:image" content="/tsec/img/poster.png" /><meta name="og:title" content="TSec" /><meta name="og:site_name" content="TSec" /><meta name="og:url" content="https://jmcardon.github.io/tsec/" /><meta name="og:type" content="website" /><meta name="og:description" content="A Type-Safe General Cryptography Library on the JVM" /><link rel="icon" type="image/png" href="/tsec/img/favicon.png" /><meta name="twitter:title" content="TSec" /><meta name="twitter:image" content="https://jmcardon.github.io/tsec/img/poster.png" /><meta name="twitter:description" content="A Type-Safe General Cryptography Library on the JVM" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/tsec/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/tsec/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/tsec/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/tsec/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/tsec/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/tsec/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/tsec/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/tsec/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/tsec/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/tsec/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/tsec/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/tsec/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/tsec/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/tsec/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/tsec/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/tsec/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/tsec/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/tsec/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/tsec/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/tsec/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/tsec/highlight/styles/default.css" /><link rel="stylesheet" href="/tsec/css/style.css" /><link rel="stylesheet" href="/tsec/css/palette.css" /><link rel="stylesheet" href="/tsec/css/codemirror.css" /><link rel="stylesheet" href="/tsec/css/kazari-style.css" /><link rel="stylesheet" href="/tsec/css/monokai.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/tsec/" class="brand"><div class="brand-wrapper"><span>TSec</span></div></a></li> <li><a href="/tsec/docs/symmetric.html" class="">Symmetric Ciphers</a></li> <li><a href="/tsec/docs/messagedigests.html" class="">Message Digests</a></li> <li><a href="/tsec/docs/passwordhashers.html" class="">Password Hashers</a></li> <li><a href="/tsec/docs/mac.html" class="">Message Authentication</a></li> <li><a href="/tsec/docs/signatures.html" class="">Digital Signatures</a></li> <li><a href="/tsec/docs/jwt-mac.html" class="">JWT</a></li> <li><a href="/tsec/docs/http4s-auth.html" class="">Http4s-Auth</a> <ul class="sub_section"> <li><a href="/tsec/docs/http4s-auth.html" class="">Overview</a></li> <li><a href="/tsec/docs/http4s/auth-scookie.html" class="">Signed Cookies</a></li> <li><a href="/tsec/docs/http4s/auth-ecookie.html" class="">Encrypted Cookies</a></li> <li><a href="/tsec/docs/http4s/auth-jwt.html" class="">JWT</a></li> <li><a href="/tsec/docs/http4s/auth-bearer.html" class="">Bearer Token</a></li> <li><a href="/tsec/docs/http4s/authorization.html" class=" active ">Authorization</a></li> <li><a href="/tsec/docs/http4s/csrf.html" class="">CSRF</a></li></ul></li> <li><a href="/tsec/docs/common.html" class="">Common Utils</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/jmcardon/tsec"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/jmcardon/tsec"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('TSec A Type-Safe General Cryptography Library on the JVM');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('TSec A Type-Safe General Cryptography Library on the JVM');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="jmcardon" data-github-repo="tsec"><div class="content-wrapper"><section><h1 id="authorization">Authorization</h1>

<p>TSec provides an authorization trait that can be plugged into a <code class="highlighter-rouge">SecuredRequestHandler</code>, extended for custom logic,
composed, extended or run manually over your request and <code class="highlighter-rouge">flatMap</code>ped.</p>

<p>Let’s look at the signature for Authorization</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">trait</span> <span class="nc">Authorization</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>, <span class="kt">Identity</span>, <span class="kt">Auth</span><span class="o">]</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">isAuthorized</span><span class="o">(</span><span class="n">toAuth</span><span class="k">:</span> <span class="kt">SecuredRequest</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">Identity</span>, <span class="kt">Auth</span><span class="o">])</span><span class="k">:</span> <span class="kt">OptionT</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">SecuredRequest</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">Identity</span>, <span class="kt">Auth</span><span class="o">]]</span>
<span class="o">}</span>
</code></pre></div></div>

<p>That is: An effect type, an identity type (i.e your user type) and an authenticator (your token type). 
In essence, this allows you to perform authorization actions based on the type of secured request you have, and extend custom
logic if you need to, to do complicated actions such as caching tokens for an endpoint where authorization may be expensive.</p>

<p>Authorizations compose. After all, we can model it as a monoid (and we also provide a monoid instance for authorization)
 as such:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">object</span> <span class="nc">Authorization</span> <span class="o">{</span>
  <span class="k">implicit</span> <span class="k">def</span> <span class="n">authorizationMonoid</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span><span class="kt">:</span> <span class="kt">Monad</span>, <span class="kt">I</span>, <span class="kt">Auth</span><span class="o">]</span><span class="k">:</span> <span class="kt">Monoid</span><span class="o">[</span><span class="kt">Authorization</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">I</span>, <span class="kt">Auth</span><span class="o">]]</span> <span class="k">=</span>
    <span class="k">new</span> <span class="nc">Monoid</span><span class="o">[</span><span class="kt">Authorization</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">I</span>, <span class="kt">Auth</span><span class="o">]]</span> <span class="o">{</span>
      <span class="k">def</span> <span class="n">empty</span><span class="k">:</span> <span class="kt">Authorization</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">I</span>, <span class="kt">Auth</span><span class="o">]</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Authorization</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">I</span>, <span class="kt">Auth</span><span class="o">]</span> <span class="o">{</span>

        <span class="k">def</span> <span class="n">isAuthorized</span><span class="o">(</span><span class="n">toAuth</span><span class="k">:</span> <span class="kt">SecuredRequest</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">I</span>, <span class="kt">Auth</span><span class="o">])</span><span class="k">:</span> <span class="kt">OptionT</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">SecuredRequest</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">I</span>, <span class="kt">Auth</span><span class="o">]]</span> <span class="k">=</span>
          <span class="nc">OptionT</span><span class="o">.</span><span class="n">pure</span><span class="o">(</span><span class="n">toAuth</span><span class="o">)</span>
      <span class="o">}</span>

      <span class="k">def</span> <span class="n">combine</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Authorization</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">I</span>, <span class="kt">Auth</span><span class="o">],</span> <span class="n">y</span><span class="k">:</span> <span class="kt">Authorization</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">I</span>, <span class="kt">Auth</span><span class="o">])</span><span class="k">:</span> <span class="kt">Authorization</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">I</span>, <span class="kt">Auth</span><span class="o">]</span> <span class="k">=</span>
        <span class="k">new</span> <span class="nc">Authorization</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">I</span>, <span class="kt">Auth</span><span class="o">]</span> <span class="o">{</span>
          <span class="k">def</span> <span class="n">isAuthorized</span><span class="o">(</span><span class="n">toAuth</span><span class="k">:</span> <span class="kt">SecuredRequest</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">I</span>, <span class="kt">Auth</span><span class="o">])</span><span class="k">:</span> <span class="kt">OptionT</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">SecuredRequest</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">I</span>, <span class="kt">Auth</span><span class="o">]]</span> <span class="k">=</span>
            <span class="n">x</span><span class="o">.</span><span class="n">isAuthorized</span><span class="o">(</span><span class="n">toAuth</span><span class="o">).</span><span class="n">flatMap</span><span class="o">(</span><span class="n">y</span><span class="o">.</span><span class="n">isAuthorized</span><span class="o">)</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>That is, our monoid empty is simply <code class="highlighter-rouge">pure</code> over the request.</p>

<p>For multiple authorizations, you could also compose manually instead of a monoid, which will create a new object
per n authorizations, by simply chaining <code class="highlighter-rouge">flatMap</code> calls.</p>

<h3 id="note">Note:</h3>

<p>Authenticators tend to rely on <code class="highlighter-rouge">SimpleAuthEnum</code>, which requires its representation type to be a primitive <code class="highlighter-rouge">Byte, Long or Int</code>,
or a <code class="highlighter-rouge">String</code></p>

<h2 id="built-in-instances">Built-in instances</h2>

<p>TSec provides a few built in instances for authorization common use cases.</p>

<h2 id="role-based-authentication">Role-based authentication.</h2>

<p>We provide two traits for <a href="https://en.wikipedia.org/wiki/Role-based_access_control">RBAC</a>: BasicRBAC and DynamicRBAC.</p>

<p>Both require an instance of <code class="highlighter-rouge">AuthorizationInfo[F, Role, U]</code>, where <code class="highlighter-rouge">Role</code> is your enum of roles that you have 
(i.e Admin, User, Staff) and U is your user type. They also rely on an <code class="highlighter-rouge">AuthGroup</code>, which is a newtype over an <code class="highlighter-rouge">Array[A]</code>
which we provide helpers to construct. It’s essentially to construct an array like a set, for faster indexing (sets are slow as hell!)</p>

<p>The main difference between <code class="highlighter-rouge">BasicRBAC</code> and <code class="highlighter-rouge">DynamicRBAC</code> is that BasicRBAC is for endpoints whose authorized roles
will never change (i.e always an admin endpoint), whereas Dynamic is for groups that may change over time, thus
it requires an instance of <code class="highlighter-rouge">trait DynamicAuthGroup[F[_], Role]</code></p>

<p>BasicRBAC provides a helper <code class="highlighter-rouge">.all</code>, which will let <em>all</em> roles pass through, and an apply method which takes
the allowed roles, i.e, from our tests:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">val</span> <span class="n">basicRBAC</span> <span class="k">=</span> <span class="nc">BasicRBAC</span><span class="o">[</span><span class="kt">IO</span>, <span class="kt">DummyRole</span>, <span class="kt">AuthDummyUser</span>, <span class="kt">Int</span><span class="o">](</span><span class="nc">DummyRole</span><span class="o">.</span><span class="nc">Admin</span><span class="o">,</span> <span class="nc">DummyRole</span><span class="o">.</span><span class="nc">Other</span><span class="o">)</span> <span class="c1">//Where DummyRole is some auth role
</span></code></pre></div></div>

<h2 id="discretionary-access-control">Discretionary access control</h2>

<p>We provide one <code class="highlighter-rouge">BasicDAC</code> class that implements the idea of discretionary access control:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">abstract</span> <span class="k">class</span> <span class="nc">BasicDAC</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>, <span class="kt">G</span>, <span class="kt">U</span>, <span class="kt">Auth</span><span class="o">](</span><span class="k">implicit</span> <span class="n">eq</span><span class="k">:</span> <span class="kt">Eq</span><span class="o">[</span><span class="kt">G</span><span class="o">],</span> <span class="n">F</span><span class="k">:</span> <span class="kt">MonadError</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">Throwable</span><span class="o">])</span>
    <span class="k">extends</span> <span class="nc">Authorization</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">U</span>, <span class="kt">Auth</span><span class="o">]</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">fetchGroup</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">AuthGroup</span><span class="o">[</span><span class="kt">G</span><span class="o">]]</span>

  <span class="k">def</span> <span class="n">fetchOwner</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">G</span><span class="o">]</span>

  <span class="k">def</span> <span class="n">fetchAccess</span><span class="o">(</span><span class="n">u</span><span class="k">:</span> <span class="kt">SecuredRequest</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">U</span>, <span class="kt">Auth</span><span class="o">])</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">G</span><span class="o">]</span>
  <span class="c1">//...
</span></code></pre></div></div>

<p>Wherein you have to implement fetchGroup and fetchOwner for a resource or particular request. i.e, from our tests:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="k">val</span> <span class="n">basicDAC</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">BasicDAC</span><span class="o">[</span><span class="kt">IO</span>, <span class="kt">Int</span>, <span class="kt">AuthDummyUser</span>, <span class="kt">Int</span><span class="o">]</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">fetchGroup</span><span class="k">:</span> <span class="kt">IO</span><span class="o">[</span><span class="kt">AuthGroup</span><span class="o">[</span><span class="kt">Int</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">IO</span><span class="o">.</span><span class="n">pure</span><span class="o">(</span><span class="nc">AuthGroup</span><span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">6</span><span class="o">))</span>

    <span class="k">def</span> <span class="n">fetchOwner</span><span class="k">:</span> <span class="kt">IO</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">IO</span><span class="o">.</span><span class="n">pure</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>

    <span class="k">def</span> <span class="n">fetchAccess</span><span class="o">(</span><span class="n">u</span><span class="k">:</span> <span class="kt">SecuredRequest</span><span class="o">[</span><span class="kt">IO</span>, <span class="kt">AuthDummyUser</span>, <span class="kt">Int</span><span class="o">])</span><span class="k">:</span> <span class="kt">IO</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">IO</span><span class="o">.</span><span class="n">pure</span><span class="o">(</span><span class="n">u</span><span class="o">.</span><span class="n">identity</span><span class="o">.</span><span class="n">id</span><span class="o">)</span>
  <span class="o">}</span>
</code></pre></div></div>

<h2 id="hierarchy-based-access-control">Hierarchy-based access control</h2>

<p>Similar to say, the linux kernel, wherein you have roles that could be numerically represented in a hierarchy,
we have a <code class="highlighter-rouge">HierarchyAuth</code> class.</p>

<p>Note:</p>
<ul>
  <li>The highest allowed auth level is 0, like the linux kernel.</li>
  <li>Higher authorization means smaller in number</li>
  <li>Your authorization enum must be numerical.</li>
</ul>

<p>As an example, an auth enum could be:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">sealed</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">AuthLevel</span><span class="o">(</span><span class="n">i</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span>
<span class="k">object</span> <span class="nc">AuthLevel</span> <span class="k">extends</span> <span class="nc">SimpleAuthEnum</span><span class="o">[</span><span class="kt">AuthLevel</span>, <span class="kt">Int</span><span class="o">]</span> <span class="o">{</span>
  <span class="k">implicit</span> <span class="k">object</span> <span class="nc">CEO</span>           <span class="k">extends</span> <span class="nc">AuthLevel</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="c1">//Implicit obj to get over SI-7046 which still pops up sometimes
</span>  <span class="k">implicit</span> <span class="k">object</span> <span class="nc">Staff</span>         <span class="k">extends</span> <span class="nc">AuthLevel</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
  <span class="k">implicit</span> <span class="k">object</span> <span class="nc">AugmentedUser</span> <span class="k">extends</span> <span class="nc">AuthLevel</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
  <span class="k">implicit</span> <span class="k">object</span> <span class="nc">RegularUser</span>   <span class="k">extends</span> <span class="nc">AuthLevel</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span>
  <span class="k">implicit</span> <span class="k">object</span> <span class="nc">Err</span>           <span class="k">extends</span> <span class="nc">AuthLevel</span><span class="o">(-</span><span class="mi">1</span><span class="o">)</span>

  <span class="k">val</span> <span class="n">getRepr</span><span class="k">:</span> <span class="o">(</span><span class="kt">AuthLevel</span><span class="o">)</span> <span class="o">=&gt;</span> <span class="nc">Int</span>            <span class="k">=</span> <span class="k">_</span><span class="o">.</span><span class="n">i</span>
  <span class="k">protected</span> <span class="k">val</span> <span class="n">values</span><span class="k">:</span> <span class="kt">AuthGroup</span><span class="o">[</span><span class="kt">AuthLevel</span><span class="o">]</span> <span class="k">=</span> <span class="nc">AuthGroup</span><span class="o">(</span><span class="nc">CEO</span><span class="o">,</span> <span class="nc">Staff</span><span class="o">,</span> <span class="nc">AugmentedUser</span><span class="o">,</span> <span class="nc">RegularUser</span><span class="o">)</span>
  <span class="k">val</span> <span class="n">orElse</span><span class="k">:</span> <span class="kt">AuthLevel</span>                      <span class="o">=</span> <span class="nc">Err</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Wherein our highest authorized role is <code class="highlighter-rouge">CEO</code>, then you can create an authorization like:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">val</span> <span class="n">hierarchyAuth</span><span class="k">:</span> <span class="kt">IO</span><span class="o">[</span><span class="kt">HierarchyAuth</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">AuthLevel</span>, <span class="kt">MyUserType</span>, <span class="kt">JWTMac</span><span class="o">[</span><span class="kt">A</span><span class="o">]]]</span> <span class="k">=</span> 
    <span class="nc">HierarchyAuth</span><span class="o">[</span><span class="kt">IO</span>, <span class="kt">AuthLevel</span>, <span class="kt">MyUserType</span>, <span class="kt">JWTMac</span><span class="o">[</span><span class="kt">A</span><span class="o">]](</span><span class="nc">AuthLevel</span><span class="o">.</span><span class="nc">Staff</span><span class="o">)</span> 
</code></pre></div></div>

<p>Hierarchy based authorization will let any higher or equal authorization pass, and deny all the rest,
thus, in our example, using <code class="highlighter-rouge">AuthLevel.Staff</code> (aka 1), this authorization allows either <code class="highlighter-rouge">CEO</code> or <code class="highlighter-rouge">Staff</code> to use
this endpoint.</p>

<h2 id="bell-lapadula">Bell-LaPadula</h2>

<p>As a final built-in enum, we offer the classic, <a href="https://en.wikipedia.org/wiki/Bell%E2%80%93LaPadula_model">Bell-LaPadula</a>
authorization model. we have two things that concern us, reading, and writing, thus we have:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">sealed</span> <span class="k">abstract</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">BLPReadAction</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>, <span class="kt">Role</span>, <span class="kt">A</span>, <span class="kt">Auth</span><span class="o">](</span><span class="n">authLevel</span><span class="k">:</span> <span class="kt">Role</span><span class="o">)(</span>
    <span class="k">implicit</span> <span class="n">authInfo</span><span class="k">:</span> <span class="kt">AuthorizationInfo</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">Role</span>, <span class="kt">A</span><span class="o">],</span>
    <span class="n">enum</span><span class="k">:</span> <span class="kt">SimpleAuthEnum</span><span class="o">[</span><span class="kt">Role</span>, <span class="kt">Int</span><span class="o">],</span>
    <span class="n">F</span><span class="k">:</span> <span class="kt">MonadError</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">Throwable</span><span class="o">]</span>
<span class="o">)</span>
<span class="k">sealed</span> <span class="k">abstract</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">BLPWriteAction</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>, <span class="kt">Role</span>, <span class="kt">A</span>, <span class="kt">Auth</span><span class="o">](</span><span class="n">authLevel</span><span class="k">:</span> <span class="kt">Role</span><span class="o">)(</span>
    <span class="k">implicit</span> <span class="n">authInfo</span><span class="k">:</span> <span class="kt">AuthorizationInfo</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">Role</span>, <span class="kt">A</span><span class="o">],</span>
    <span class="n">enum</span><span class="k">:</span> <span class="kt">SimpleAuthEnum</span><span class="o">[</span><span class="kt">Role</span>, <span class="kt">Int</span><span class="o">],</span>
    <span class="n">F</span><span class="k">:</span> <span class="kt">MonadError</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">Throwable</span><span class="o">]</span>
<span class="o">)</span> 
</code></pre></div></div>

<p>Similar to hierarchy-based auth, except that there is no reading to a higher authorization level (i.e lower in number),
and no writing to any auth level but your own (strong star property).</p>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/tsec/highlight/highlight.pack.js"></script><script>hljs.configure({
languages:['scala','java','bash']
});
hljs.initHighlighting();
             </script><script src="/tsec/js/main.js"></script><script src="/tsec/js/kazari.js"></script><script>
$(document).ready(function() {
	kazari.KazariPlugin().decorateCode('https://scala-evaluator-212.herokuapp.com/eval', 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.S2F6YXJp.Jl2eqMfw8IakJF93PjxTbrf-8YUJgX5OoOfy5JHE8Yw', '', 'monokai')
})
    </script></body></html>